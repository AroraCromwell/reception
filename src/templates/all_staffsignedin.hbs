<div class="container">
    <div class="row">
        <div class="col-md-12">
            <table id="datatable" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
                <thead>
                <tr>
                    <th>UserId</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Sign In</th>
                    <th>Sign Out</th>
                    <th>image</th>
                    <th>Action</th>
                </tr>
                </thead>

                <tbody>
                {{#each data}}
                    <tr>
                        <td>{{staff_id}}</td>
                        <td>{{first_name}} {{surname}}</td>
                        <td>{{email}}</td>
                        <td id="signout_time">{{signin_time}}</td>

                    {{#if signout_time}}
                        <td >{{signout_time}}</td>
                    {{else}}
                        <td>In The Building</td>
                    {{/if}}
                        <td><img src="https://reception.cromwell-tools.co.uk/images/{{staff_id}}.jpg" style="width: 125px;length:100px;"/></td>
                        <!--<td><img src="http://10.100.16.62:7000/images/{{staff_id}}.jpg" style="width: 125px;length:100px;"/></td>-->
                        <!--<td class="target text-center"><a class="btn btn-sm btn-primary" href="#" id="">SignOut</a></td>-->
                        {{#if signout_time}}
                            <td  class =""  id="" href="" style="margin-top: 36px;margin-right: 10px;">Signed Out</td>
                        {{else}}
                            <td  class ="target btn btn-primary btn-sm btn-space"    id="{{staff_id}}" href="" style="margin-top: 36px;margin-right: 10px;">
                                Sign Me Out!
                            </td>
                        {{/if}}
                    </tr>
                {{/each}}

                </tbody>
            </table>
        </div>
    </div>

</div>

<script src="/js/jquery-1.12.3.min.js" ></script>
<script>
    var table ="";
    $(function() {
        table = $('#datatable').DataTable( {
            "order": [[ 3, "desc" ]]
        });
    });


//    $( "#Signout" ).click(function() {
//        alert( "Handler for .click() called." );
//    });
    var chk = new Date();
    var month = chk.getMonth()+1;
    var myDate = [chk.getFullYear(), month <10 ? '0' + month : month , chk.getDate() < 10 ? '0' + chk.getDate() : chk.getDate()].join('-');
    var myTime = new Date().toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/, "$1");



        $(".target").click(function(){
        console.log("button clicked");

            var line = this;
            var contentPanelId = jQuery(this).attr("id");
           // alert(contentPanelId);
            $.ajax({
                url: '/staffSignOut/'+contentPanelId,
                type: 'GET',
                success: function(response) {
                    //...
                    table
                            .row( $(line).parents('tr').find('td').eq(4).text(myDate + ' ' + myTime))
                            .row( $(line).attr({class: '', }) )
                            .row( $(line).html('Signed Out') )
                            .draw();
                },
                error: function () {
                    //your error code
                }
            });
        });

</script>
